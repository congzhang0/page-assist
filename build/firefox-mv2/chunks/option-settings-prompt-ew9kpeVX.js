import{e as M,r as n,a as O,j as e}from"./FontSizeProvider-D3enan1E.js";import{S as Z}from"./SettingsOptionLayout-s4bKEO4h.js";import{O as $}from"./Layout-_1TcQUPd.js";import{M as f,T as L}from"./pdfjs-Dk_2IB0p.js";import{F as s,u as w,e as l,n as S,S as N,T as U}from"./SaveButton-DmOKJM4n.js";import{y as W,n as o,z as X,F as Y,G as ee,H as te,Z as re,J as se,K as ae}from"./Sidebar-BePlkV0h.js";import{P as F,t as oe}from"./color-Vokuk9CD.js";import{S as ne}from"./index--q6D0B7A.js";import{I as m,T as x}from"./browser-polyfill-0iagK1yo.js";import{T as q}from"./Table-BtJuQl0B.js";import"./index-FcDqmjI2.js";import"./chevron-right-CQkEQ8H0.js";import"./index-zywBqqSA.js";import"./index-Ci6F2mfP.js";import"./index-C5awg_Th.js";import"./index-AkKl93ew.js";const me=()=>{const i=M(),[I,c]=n.useState(!1),[E,d]=n.useState(!1),[T,z]=n.useState(""),[h]=s.useForm(),[p]=s.useForm(),{t}=O(["settings","common"]),[y,C]=n.useState("custom"),[K,g]=n.useState(!1),[A,R]=n.useState(""),[u]=s.useForm(),{data:D,status:P}=w({queryKey:["fetchAllPrompts"],queryFn:se}),{data:Q,status:j}=w({queryKey:["fetchCopilotPrompts"],queryFn:ae}),{mutate:_}=l({mutationFn:W,onSuccess:()=>{i.invalidateQueries({queryKey:["fetchAllPrompts"]}),o.success({message:t("managePrompts.notification.deletedSuccess"),description:t("managePrompts.notification.deletedSuccessDesc")})},onError:r=>{o.error({message:t("managePrompts.notification.error"),description:(r==null?void 0:r.message)||t("managePrompts.notification.someError")})}}),{mutate:V,isPending:b}=l({mutationFn:X,onSuccess:()=>{i.invalidateQueries({queryKey:["fetchAllPrompts"]}),c(!1),h.resetFields(),o.success({message:t("managePrompts.notification.addSuccess"),description:t("managePrompts.notification.addSuccessDesc")})},onError:r=>{o.error({message:t("managePrompts.notification.error"),description:(r==null?void 0:r.message)||t("managePrompts.notification.someError")})}}),{mutate:B,isPending:k}=l({mutationFn:async r=>await Y({...r,id:T}),onSuccess:()=>{i.invalidateQueries({queryKey:["fetchAllPrompts"]}),d(!1),p.resetFields(),o.success({message:t("managePrompts.notification.updatedSuccess"),description:t("managePrompts.notification.updatedSuccessDesc")})},onError:r=>{o.error({message:t("managePrompts.notification.error"),description:(r==null?void 0:r.message)||t("managePrompts.notification.someError")})}}),{mutate:G,isPending:v}=l({mutationFn:async r=>await ee([{key:r.key,prompt:r.prompt}]),onSuccess:()=>{i.invalidateQueries({queryKey:["fetchCopilotPrompts"]}),g(!1),u.resetFields(),o.success({message:t("managePrompts.notification.updatedSuccess"),description:t("managePrompts.notification.updatedSuccessDesc")})},onError:r=>{o.error({message:t("managePrompts.notification.error"),description:(r==null?void 0:r.message)||t("managePrompts.notification.someError")})}});function H(){return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"-ml-4 -mt-2 flex flex-wrap items-center justify-end sm:flex-nowrap",children:e.jsx("div",{className:"ml-4 mt-2 flex-shrink-0",children:e.jsx("button",{onClick:()=>c(!0),className:"inline-flex items-center rounded-md border border-transparent bg-black px-2 py-2 text-md font-medium leading-4 text-white shadow-sm hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50",children:t("managePrompts.addBtn")})})})}),P==="pending"&&e.jsx(N,{paragraph:{rows:8}}),P==="success"&&e.jsx(q,{columns:[{title:t("managePrompts.columns.title"),dataIndex:"title",key:"title",render:r=>e.jsx("span",{className:"line-clamp-1",children:r})},{title:t("managePrompts.columns.prompt"),dataIndex:"content",key:"content",render:r=>e.jsx("span",{className:"line-clamp-1",children:r})},{title:t("managePrompts.columns.type"),dataIndex:"is_system",key:"is_system",render:r=>e.jsx("span",{className:"flex items-center gap-2 text-xs w-32",children:r?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"size-4"})," ",t("managePrompts.systemPrompt")]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"size-4"})," ",t("managePrompts.quickPrompt")]})})},{title:t("managePrompts.columns.actions"),render:(r,a)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx(x,{title:t("managePrompts.tooltip.delete"),children:e.jsx("button",{onClick:()=>{window.confirm(t("managePrompts.confirm.delete"))&&_(a.id)},className:"text-red-500 dark:text-red-400",children:e.jsx(U,{className:"size-4"})})}),e.jsx(x,{title:t("managePrompts.tooltip.edit"),children:e.jsx("button",{onClick:()=>{z(a.id),p.setFieldsValue(a),d(!0)},className:"text-gray-500 dark:text-gray-400",children:e.jsx(F,{className:"size-4"})})})]})}],bordered:!0,dataSource:D,rowKey:r=>r.id})]})}function J(){return e.jsxs("div",{children:[j==="pending"&&e.jsx(N,{paragraph:{rows:8}}),j==="success"&&e.jsx(q,{columns:[{title:t("managePrompts.columns.title"),dataIndex:"key",key:"key",render:r=>e.jsx("span",{className:"line-clamp-1",children:e.jsx(L,{color:oe[r||"default"],children:t(`common:copilot.${r}`)})})},{title:t("managePrompts.columns.prompt"),dataIndex:"prompt",key:"prompt",render:r=>e.jsx("span",{className:"line-clamp-1",children:r})},{render:(r,a)=>e.jsx("div",{className:"flex gap-4",children:e.jsx(x,{title:t("managePrompts.tooltip.edit"),children:e.jsx("button",{onClick:()=>{R(a.key),u.setFieldsValue(a),g(!0)},className:"text-gray-500 dark:text-gray-400",children:e.jsx(F,{className:"size-4"})})})})}],bordered:!0,dataSource:Q,rowKey:r=>r.key})]})}return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-end mb-6",children:e.jsx(ne,{size:"large",options:[{label:t("managePrompts.segmented.custom"),value:"custom"},{label:t("managePrompts.segmented.copilot"),value:"copilot"}],onChange:r=>{C(r)}})}),y==="custom"&&H(),y==="copilot"&&J(),e.jsx(f,{title:t("managePrompts.modal.addTitle"),open:I,onCancel:()=>c(!1),footer:null,children:e.jsxs(s,{onFinish:r=>V(r),layout:"vertical",form:h,children:[e.jsx(s.Item,{name:"title",label:t("managePrompts.form.title.label"),rules:[{required:!0,message:t("managePrompts.form.title.required")}],children:e.jsx(m,{placeholder:t("managePrompts.form.title.placeholder")})}),e.jsx(s.Item,{name:"content",label:t("managePrompts.form.prompt.label"),rules:[{required:!0,message:t("managePrompts.form.prompt.required")}],help:t("managePrompts.form.prompt.help"),children:e.jsx(m.TextArea,{placeholder:t("managePrompts.form.prompt.placeholder"),autoSize:{minRows:3,maxRows:10}})}),e.jsx(s.Item,{name:"is_system",label:t("managePrompts.form.isSystem.label"),valuePropName:"checked",children:e.jsx(S,{})}),e.jsx(s.Item,{children:e.jsx("button",{disabled:b,className:"inline-flex justify-center w-full text-center mt-4 items-center rounded-md border border-transparent bg-black px-2 py-2 text-sm font-medium leading-4 text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50 ",children:t(b?"managePrompts.form.btnSave.saving":"managePrompts.form.btnSave.save")})})]})}),e.jsx(f,{title:t("managePrompts.modal.editTitle"),open:E,onCancel:()=>d(!1),footer:null,children:e.jsxs(s,{onFinish:r=>B(r),layout:"vertical",form:p,children:[e.jsx(s.Item,{name:"title",label:t("managePrompts.form.title.label"),rules:[{required:!0,message:t("managePrompts.form.title.required")}],children:e.jsx(m,{placeholder:t("managePrompts.form.title.placeholder")})}),e.jsx(s.Item,{name:"content",label:t("managePrompts.form.prompt.label"),rules:[{required:!0,message:t("managePrompts.form.prompt.required")}],help:t("managePrompts.form.prompt.help"),children:e.jsx(m.TextArea,{placeholder:t("managePrompts.form.prompt.placeholder"),autoSize:{minRows:3,maxRows:10}})}),e.jsx(s.Item,{name:"is_system",label:t("managePrompts.form.isSystem.label"),valuePropName:"checked",children:e.jsx(S,{})}),e.jsx(s.Item,{children:e.jsx("button",{disabled:k,className:"inline-flex justify-center w-full text-center mt-4 items-center rounded-md border border-transparent bg-black px-2 py-2 text-sm font-medium leading-4 text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50 ",children:t(k?"managePrompts.form.btnEdit.saving":"managePrompts.form.btnEdit.save")})})]})}),e.jsx(f,{title:t("managePrompts.modal.editTitle"),open:K,onCancel:()=>g(!1),footer:null,children:e.jsxs(s,{onFinish:r=>G({key:A,prompt:r.prompt}),layout:"vertical",form:u,children:[e.jsx(s.Item,{name:"prompt",label:t("managePrompts.form.prompt.label"),rules:[{required:!0,message:t("managePrompts.form.prompt.required")},{validator:(r,a)=>a&&a.includes("{text}")?Promise.resolve():Promise.reject(new Error(t("managePrompts.form.prompt.missingTextPlaceholder")))}],children:e.jsx(m.TextArea,{placeholder:t("managePrompts.form.prompt.placeholder"),autoSize:{minRows:3,maxRows:10}})}),e.jsx(s.Item,{children:e.jsx("button",{disabled:v,className:"inline-flex justify-center w-full text-center mt-4 items-center rounded-md border border-transparent bg-black px-2 py-2 text-sm font-medium leading-4 text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50 ",children:t(v?"managePrompts.form.btnEdit.saving":"managePrompts.form.btnEdit.save")})})]})})]})},ie=()=>e.jsx($,{children:e.jsx(Z,{children:e.jsx(me,{})})});export{ie as default};
