import{a as G,r as m,e as Q,j as e,__tla as D}from"./FontSizeProvider-D4Gh80tw.js";import{S as E,__tla as R}from"./SettingsOptionLayout-gi-p9doQ.js";import{O as H,__tla as J}from"./Layout-B2rmxZ24.js";import{u as T,e as w,D as f,as as W,at as X,au as Y,F as x,T as K,G as V,S as Z,av as ee,aw as ae,ax as le,M as se}from"./SaveButton-Dir2VHfX.js";import{s as S}from"./chevron-right-CDZTKm5_.js";import{S as te,T as re,__tla as ie}from"./Table-IhjToR31.js";import{C as B}from"./index-B2Ick9Fr.js";import{R as L}from"./index-Bbm-Nfcp.js";import{q as de,s as ne,x as oe,y as ce,t as P,ai as me,__tla as ue}from"./Sidebar-uBkE2MHz.js";import"./index-DZCUgEun.js";let $,xe=Promise.all([(()=>{try{return D}catch{}})(),(()=>{try{return R}catch{}})(),(()=>{try{return J}catch{}})(),(()=>{try{return ie}catch{}})(),(()=>{try{return ue}catch{}})()]).then(async()=>{let z,U,y,O;z=({openaiId:l,setOpenModelModal:_})=>{const{t:r}=G(["openai"]),[i,h]=m.useState([]),[g,n]=m.useState(""),[v,j]=m.useState("chat"),C=Q(),{data:d,status:p}=T({queryKey:["openAIConfigs",l],queryFn:async()=>{const s=await W(l);return await X({baseUrl:s.baseUrl,apiKey:s.apiKey,customHeaders:s.headers})},enabled:!!l}),o=m.useMemo(()=>(d==null?void 0:d.filter(s=>(s.name??s.id).toLowerCase().includes(g.toLowerCase())))||[],[d,g]),I=s=>{h(s?o.map(c=>c.id):[])},k=(s,c)=>{h(c?a=>[...a,s]:a=>a.filter(t=>t!==s))},F=async s=>{const c=s.map(a=>{var t;return{model_id:a,name:((t=o.find(u=>u.id===a))==null?void 0:t.name)??a,provider_id:l,model_type:v}});return await Y(c),!0},{mutate:q,isPending:N}=w({mutationFn:F,onSuccess:()=>{_(!1),C.invalidateQueries({queryKey:["fetchModel"]}),S.success(r("modal.model.success"))}}),M=()=>{q(i)};return p==="pending"?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(te,{size:"large"})}):p==="error"||!d||d.length===0?e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("p",{className:"text-md text-center text-gray-600 dark:text-gray-300",children:r("noModelFound")})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r("modal.model.subheading")}),e.jsx(f,{placeholder:r("searchModel"),value:g,onChange:s=>n(s.target.value),className:"w-full"}),e.jsxs("div",{className:"flex  justify-between",children:[e.jsx(B,{checked:i.length===o.length,indeterminate:i.length>0&&i.length<o.length,onChange:s=>I(s.target.checked),children:r("selectAll")}),e.jsx("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:`${i==null?void 0:i.length} / ${d==null?void 0:d.length}`})]}),e.jsx("div",{className:"space-y-2 custom-scrollbar max-h-[300px] border overflow-y-auto dark:border-gray-600 rounded-md p-3",children:e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:o.map((s,c)=>e.jsx("div",{onClick:()=>{k(s.id,!i.includes(s.id))},className:"flex cursor-pointer items-center justify-between py-3 hover:bg-gray-50 dark:hover:bg-gray-800 px-2 ",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{checked:i.includes(s.id),onChange:a=>k(s.id,a.target.checked)}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:`${(s==null?void 0:s.name)||s.id}`.replaceAll(/accounts\/[^\/]+\/models\//g,"")}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.id})]})]})},c))})}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs(L.Group,{onChange:s=>j(s.target.value),value:v,children:[e.jsx(L,{value:"chat",children:r("radio.chat")}),e.jsx(L,{value:"embedding",children:r("radio.embedding")})]}),e.jsx(de,{content:e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("b",{className:"text-gray-800 dark:text-gray-100",children:r("radio.chat")})," ",r("radio.chatInfo")]}),e.jsxs("p",{children:[e.jsx("b",{className:"text-gray-800 dark:text-gray-100",children:r("radio.embedding")})," ",r("radio.embeddingInfo")]})]}),children:e.jsx(ne,{className:"ml-2 h-4 w-4 text-gray-500 cursor-pointer"})})]}),e.jsx("button",{onClick:M,disabled:N,className:"inline-flex justify-center w-full text-center mt-4 items-center rounded-md border border-transparent bg-black px-2 py-2 text-sm font-medium leading-4 text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50",children:r(N?"saving":"save")})]})},U=[{label:"Custom",value:"custom",baseUrl:""},{label:"LLaMa.cpp",value:"llamacpp",baseUrl:"http://localhost:8080/v1"},{label:"LM Studio",value:"lmstudio",baseUrl:"http://localhost:1234/v1"},{label:"Llamafile",value:"llamafile",baseUrl:"http://127.0.0.1:8080/v1"},{label:"Ollama",value:"ollama2",baseUrl:"http://localhost:11434/v1"},{label:"OpenAI",value:"openai",baseUrl:"https://api.openai.com/v1"},{label:"DeepSeek",value:"deepseek",baseUrl:"https://api.deepseek.com"},{label:"Fireworks",value:"fireworks",baseUrl:"https://api.fireworks.ai/inference/v1"},{label:"Novita AI",value:"novita",baseUrl:"https://api.novita.ai/v3/openai"},{label:"Groq",value:"groq",baseUrl:"https://api.groq.com/openai/v1"},{label:"Together",value:"together",baseUrl:"https://api.together.xyz/v1"},{label:"OpenRouter",value:"openrouter",baseUrl:"https://openrouter.ai/api/v1"},{label:"Google AI",value:"gemini",baseUrl:"https://generativelanguage.googleapis.com/v1beta/openai"},{label:"Mistral",value:"mistral",baseUrl:"https://api.mistral.ai/v1"},{label:"Infinigence AI",value:"infinitenceai",baseUrl:"https://cloud.infini-ai.com/maas/v1"},{label:"SiliconFlow",value:"siliconflow",baseUrl:"https://api.siliconflow.cn/v1"},{label:"VolcEngine",value:"volcengine",baseUrl:"https://ark.cn-beijing.volces.com/api/v3"},{label:"TencentCloud",value:"tencentcloud",baseUrl:"https://api.lkeap.cloud.tencent.com/v1"},{label:"AliBaBaCloud",value:"alibabacloud",baseUrl:"https://dashscope.aliyuncs.com/compatible-mode/v1"}],y=["lmstudio","llamafile","ollama2","llamacpp"],O=()=>{const{t:l}=G(["openai","settings"]),[_,r]=m.useState(!1),[i,h]=m.useState(null),g=Q(),[n]=x.useForm(),[v,j]=m.useState(null),[C,d]=m.useState(!1),[p,o]=m.useState("custom"),{data:I,isLoading:k}=T({queryKey:["openAIConfigs"],queryFn:se}),F=w({mutationFn:ee,onSuccess:a=>{g.invalidateQueries({queryKey:["openAIConfigs"]}),r(!1),S.success(l("addSuccess")),y.includes(p)||(j(a),d(!0)),n.resetFields(),o("custom")}}),q=w({mutationFn:ae,onSuccess:()=>{g.invalidateQueries({queryKey:["openAIConfigs"]}),r(!1),n.resetFields(),h(null),S.success(l("updateSuccess"))}}),N=w({mutationFn:le,onSuccess:()=>{g.invalidateQueries({queryKey:["openAIConfigs"]}),S.success(l("deleteSuccess"))}}),M=a=>{i?q.mutate({id:i.id,...a}):F.mutate({...a,provider:p})},s=a=>{h({...a,headers:(a==null?void 0:a.headers)||[]}),n.setFieldsValue({...a,headers:(a==null?void 0:a.headers)||[]}),r(!0)},c=a=>{N.mutate(a)};return e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold leading-7 text-gray-900 dark:text-white",children:l("heading")}),e.jsx("p",{className:"mt-1 text-sm leading-6 text-gray-600 dark:text-gray-400",children:l("subheading")}),e.jsx("div",{className:"border border-b border-gray-200 dark:border-gray-600 mt-3 mb-6"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"-ml-4 -mt-2 flex flex-wrap items-center justify-end sm:flex-nowrap",children:e.jsx("div",{className:"ml-4 mt-2 flex-shrink-0",children:e.jsx("button",{onClick:()=>{h(null),r(!0),n.resetFields()},className:"inline-flex items-center rounded-md border border-transparent bg-black px-2 py-2 text-md font-medium leading-4 text-white shadow-sm hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50",children:l("addBtn")})})})}),e.jsx(re,{columns:[{title:l("table.name"),dataIndex:"name",key:"name"},{title:l("table.baseUrl"),dataIndex:"baseUrl",key:"baseUrl"},{title:l("table.actions"),key:"actions",render:(a,t)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx(K,{title:l("edit"),children:e.jsx("button",{className:"text-gray-700 dark:text-gray-400",onClick:()=>s(t),children:e.jsx(oe,{className:"size-4"})})}),e.jsx(K,{title:y.includes(t.provider)?l("noNewModel"):l("newModel"),children:e.jsx("button",{className:"text-gray-700 dark:text-gray-400 disabled:opacity-50",onClick:()=>{d(!0),j(t.id)},disabled:!t.id||y.includes(t.provider),children:e.jsx(ce,{className:"size-4"})})}),e.jsx(K,{title:l("delete"),children:e.jsx("button",{className:"text-red-500 dark:text-red-400",onClick:()=>{confirm(l("modal.deleteConfirm",{name:t.name}))&&c(t.id)},children:e.jsx(V,{className:"size-4"})})})]})}],dataSource:I,loading:k,rowKey:"id",bordered:!0}),e.jsxs(P,{open:_,title:l(i?"modal.titleEdit":"modal.titleAdd"),onCancel:()=>{r(!1),h(null),o("custom"),n.resetFields()},footer:null,children:[!i&&e.jsx(Z,{value:p,onSelect:a=>{const t=U.find(u=>u.value===a);n.setFieldsValue({baseUrl:t==null?void 0:t.baseUrl,name:t==null?void 0:t.label}),o(a)},filterOption:(a,t)=>{var u,b,A;return((A=(b=(u=t==null?void 0:t.label)==null?void 0:u.props["data-title"])==null?void 0:b.toLowerCase())==null?void 0:A.indexOf(a.toLowerCase()))>=0},showSearch:!0,className:"w-full !mb-4",options:U.map(a=>({value:a.value,label:e.jsxs("span",{"data-title":a.label,className:"flex flex-row gap-3 items-center ",children:[e.jsx(me,{provider:a.value,className:"size-5"}),e.jsx("span",{className:"line-clamp-2",children:a.label})]},a.value)}))}),e.jsxs(x,{form:n,layout:"vertical",onFinish:M,initialValues:{...i},children:[e.jsx(x.Item,{name:"name",label:l("modal.name.label"),rules:[{required:!0,message:l("modal.name.required")}],children:e.jsx(f,{size:"large",placeholder:l("modal.name.placeholder")})}),e.jsx(x.Item,{name:"baseUrl",label:l("modal.baseUrl.label"),help:l("modal.baseUrl.help"),rules:[{required:!0,message:l("modal.baseUrl.required")}],children:e.jsx(f,{size:"large",placeholder:l("modal.baseUrl.placeholder")})}),e.jsx(x.Item,{name:"apiKey",label:l("modal.apiKey.label"),children:e.jsx(f.Password,{size:"large",placeholder:l("modal.apiKey.placeholder")})}),e.jsx(x.List,{name:"headers",children:(a,{add:t,remove:u})=>e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-md font-semibold",children:l("settings:ollamaSettings.settings.advanced.headers.label")}),e.jsx("button",{type:"button",className:"dark:bg-white dark:text-black text-white bg-black p-1.5 text-xs rounded-md",onClick:()=>{t()},children:l("settings:ollamaSettings.settings.advanced.headers.add")})]}),a.map((b,A)=>e.jsxs("div",{className:"flex items-center   w-full",children:[e.jsxs("div",{className:"flex-grow flex mt-3 space-x-4",children:[e.jsx(x.Item,{label:l("settings:ollamaSettings.settings.advanced.headers.key.label"),name:[b.name,"key"],className:"flex-1 mb-0",children:e.jsx(f,{className:"w-full",placeholder:l("settings:ollamaSettings.settings.advanced.headers.key.placeholder")})}),e.jsx(x.Item,{label:l("settings:ollamaSettings.settings.advanced.headers.value.label"),name:[b.name,"value"],className:"flex-1 mb-0",children:e.jsx(f,{className:"w-full",placeholder:l("settings:ollamaSettings.settings.advanced.headers.value.placeholder")})})]}),e.jsx("button",{type:"button",onClick:()=>{u(b.name)},className:"shrink-0 ml-2 text-red-500 dark:text-red-400",children:e.jsx(V,{className:"w-5 h-5"})})]},b.key))]})}),p==="lmstudio"&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-4",children:l("modal.tipLMStudio")}),e.jsx("button",{type:"submit",className:"inline-flex justify-center w-full text-center mt-4 items-center rounded-md border border-transparent bg-black px-2 py-2 text-sm font-medium leading-4 text-white shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-white dark:text-gray-800 dark:hover:bg-gray-100 dark:focus:ring-gray-500 dark:focus:ring-offset-gray-100 disabled:opacity-50",children:l(i?"modal.update":"modal.submit")})]})]}),e.jsx(P,{open:C,title:l("modal.model.title"),footer:null,onCancel:()=>d(!1),children:v?e.jsx(z,{openaiId:v,setOpenModelModal:d}):null})]})})},$=()=>e.jsx(H,{children:e.jsx(E,{children:e.jsx(O,{})})})});export{xe as __tla,$ as default};
