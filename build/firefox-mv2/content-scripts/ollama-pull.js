var ollamaPull=function(){"use strict";function re(i){return i}function j(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var v={exports:{}},O=v.exports,L;function D(){return L||(L=1,function(i,e){(function(r,n){n(i)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:O,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const n="The message port closed before a response was received.",a=m=>{const f={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(f).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class b extends WeakMap{constructor(t,l=void 0){super(l),this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}const I=s=>s&&typeof s=="object"&&typeof s.then=="function",p=(s,t)=>(...l)=>{m.runtime.lastError?s.reject(new Error(m.runtime.lastError.message)):t.singleCallbackArg||l.length<=1&&t.singleCallbackArg!==!1?s.resolve(l[0]):s.resolve(l)},k=s=>s==1?"argument":"arguments",J=(s,t)=>function(g,...A){if(A.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${k(t.minArgs)} for ${s}(), got ${A.length}`);if(A.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${k(t.maxArgs)} for ${s}(), got ${A.length}`);return new Promise((u,d)=>{if(t.fallbackToNoCallback)try{g[s](...A,p({resolve:u,reject:d},t))}catch(o){console.warn(`${s} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),g[s](...A),t.fallbackToNoCallback=!1,t.noCallback=!0,u()}else t.noCallback?(g[s](...A),u()):g[s](...A,p({resolve:u,reject:d},t))})},K=(s,t,l)=>new Proxy(t,{apply(g,A,u){return l.call(A,s,...u)}});let C=Function.call.bind(Object.prototype.hasOwnProperty);const P=(s,t={},l={})=>{let g=Object.create(null),A={has(d,o){return o in s||o in g},get(d,o,x){if(o in g)return g[o];if(!(o in s))return;let c=s[o];if(typeof c=="function")if(typeof t[o]=="function")c=K(s,s[o],t[o]);else if(C(l,o)){let w=J(o,l[o]);c=K(s,s[o],w)}else c=c.bind(s);else if(typeof c=="object"&&c!==null&&(C(t,o)||C(l,o)))c=P(c,t[o],l[o]);else if(C(l,"*"))c=P(c,t[o],l["*"]);else return Object.defineProperty(g,o,{configurable:!0,enumerable:!0,get(){return s[o]},set(w){s[o]=w}}),c;return g[o]=c,c},set(d,o,x,c){return o in g?g[o]=x:s[o]=x,!0},defineProperty(d,o,x){return Reflect.defineProperty(g,o,x)},deleteProperty(d,o){return Reflect.deleteProperty(g,o)}},u=Object.create(s);return new Proxy(u,A)},F=s=>({addListener(t,l,...g){t.addListener(s.get(l),...g)},hasListener(t,l){return t.hasListener(s.get(l))},removeListener(t,l){t.removeListener(s.get(l))}}),Q=new b(s=>typeof s!="function"?s:function(l){const g=P(l,{},{getContent:{minArgs:0,maxArgs:0}});s(g)}),B=new b(s=>typeof s!="function"?s:function(l,g,A){let u=!1,d,o=new Promise(y=>{d=function(h){u=!0,y(h)}}),x;try{x=s(l,g,d)}catch(y){x=Promise.reject(y)}const c=x!==!0&&I(x);if(x!==!0&&!c&&!u)return!1;const w=y=>{y.then(h=>{A(h)},h=>{let R;h&&(h instanceof Error||typeof h.message=="string")?R=h.message:R="An unexpected error occurred",A({__mozWebExtensionPolyfillReject__:!0,message:R})}).catch(h=>{console.error("Failed to send onMessage rejected reply",h)})};return w(c?x:o),!0}),X=({reject:s,resolve:t},l)=>{m.runtime.lastError?m.runtime.lastError.message===n?t():s(new Error(m.runtime.lastError.message)):l&&l.__mozWebExtensionPolyfillReject__?s(new Error(l.message)):t(l)},q=(s,t,l,...g)=>{if(g.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${k(t.minArgs)} for ${s}(), got ${g.length}`);if(g.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${k(t.maxArgs)} for ${s}(), got ${g.length}`);return new Promise((A,u)=>{const d=X.bind(null,{resolve:A,reject:u});g.push(d),l.sendMessage(...g)})},ee={devtools:{network:{onRequestFinished:F(Q)}},runtime:{onMessage:F(B),onMessageExternal:F(B),sendMessage:q.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:q.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},$={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return f.privacy={network:{"*":$},services:{"*":$},websites:{"*":$}},P(m,ee,f)};r.exports=a(chrome)}})}(v)),v.exports}var U=D();const M=j(U),W={main(i){const e=async a=>confirm(`[Page Assist Extension] Do you want to pull ${a} model? This has nothing to do with Ollama.com website. The model will be pulled locally once you confirm.`)?(alert(`[Page Assist Extension] Pulling ${a} model. For more details, check the extension icon.`),await M.runtime.sendMessage({type:"pull_model",modelName:a}),!0):!1,r=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 pageasssist-icon">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
    </svg>
    `,n=document.querySelectorAll("div.language-none");for(let a=0;a<n.length;a++){const m=n[a].querySelector("button"),f=n[a].querySelector("input");if(m&&f){const b=document.createElement("button");b.innerHTML=r,b.className=`border-l ${m.className}`,b.id=`download-${a}-pageassist`;const I=f?.value.replace("ollama run","").replace("ollama pull","").trim();b.addEventListener("click",()=>{e(I)});const p=document.createElement("span");p.title="Download model via Page Assist",p.appendChild(b),m.parentNode&&m.parentNode.appendChild(p)}}},allFrames:!0,matches:["*://ollama.com/*"]};function E(i,...e){}const V={debug:(...i)=>E(console.debug,...i),log:(...i)=>E(console.log,...i),warn:(...i)=>E(console.warn,...i),error:(...i)=>E(console.error,...i)};class _ extends Event{constructor(e,r){super(_.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=r}static EVENT_NAME=N("wxt:locationchange")}function N(i){return`${M?.runtime?.id}:ollama-pull:${i}`}function H(i){let e,r;return{run(){e==null&&(r=new URL(location.href),e=i.setInterval(()=>{let n=new URL(location.href);n.href!==r.href&&(window.dispatchEvent(new _(n,r)),r=n)},1e3))}}}class S{constructor(e,r){this.contentScriptName=e,this.options=r,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=N("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=H(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return M.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,r){const n=setInterval(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(e,r){const n=setTimeout(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(e){const r=requestAnimationFrame((...n)=>{this.isValid&&e(...n)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(e,r){const n=requestIdleCallback((...a)=>{this.signal.aborted||e(...a)},r);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(e,r,n,a){r==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(r.startsWith("wxt:")?N(r):r,n,{...a,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),V.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:S.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const r=e.data?.type===S.SCRIPT_STARTED_MESSAGE_TYPE,n=e.data?.contentScriptName===this.contentScriptName,a=!this.receivedMessageIds.has(e.data?.messageId);return r&&n&&a}listenForNewerScripts(e){let r=!0;const n=a=>{if(this.verifyScriptStartedEvent(a)){this.receivedMessageIds.add(a.data.messageId);const m=r;if(r=!1,m&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}}const G=Symbol("null");let z=0;class Z extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[e]=arguments;if(e!=null){if(typeof e[Symbol.iterator]!="function")throw new TypeError(typeof e+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[r,n]of e)this.set(r,n)}}_getPublicKeys(e,r=!1){if(!Array.isArray(e))throw new TypeError("The keys parameter must be an array");const n=this._getPrivateKey(e,r);let a;return n&&this._publicKeys.has(n)?a=this._publicKeys.get(n):r&&(a=[...e],this._publicKeys.set(n,a)),{privateKey:n,publicKey:a}}_getPrivateKey(e,r=!1){const n=[];for(let a of e){a===null&&(a=G);const m=typeof a=="object"||typeof a=="function"?"_objectHashes":typeof a=="symbol"?"_symbolHashes":!1;if(!m)n.push(a);else if(this[m].has(a))n.push(this[m].get(a));else if(r){const f=`@@mkm-ref-${z++}@@`;this[m].set(a,f),n.push(f)}else return!1}return JSON.stringify(n)}set(e,r){const{publicKey:n}=this._getPublicKeys(e,!0);return super.set(n,r)}get(e){const{publicKey:r}=this._getPublicKeys(e);return super.get(r)}has(e){const{publicKey:r}=this._getPublicKeys(e);return super.has(r)}delete(e){const{publicKey:r,privateKey:n}=this._getPublicKeys(e);return!!(r&&super.delete(r)&&this._publicKeys.delete(n))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new Z;function te(){}function T(i,...e){}const Y={debug:(...i)=>T(console.debug,...i),log:(...i)=>T(console.log,...i),warn:(...i)=>T(console.warn,...i),error:(...i)=>T(console.error,...i)};return(async()=>{try{const{main:i,...e}=W,r=new S("ollama-pull",e);return await i(r)}catch(i){throw Y.error('The content script "ollama-pull" crashed on startup!',i),i}})()}();
ollamaPull;
